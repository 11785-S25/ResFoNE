2025-03-13 16:36:10 - INFO - result/test_run/train_from_scratch/gpt2/1000addition/fne/period_base_list_[10.0]_batchsize_32_epochs_5_lr_5e-05_int_digit_len_10_frac_digit_len_0_seed42_num_train_samples_10_model_size_level_-1_lengensize_0_addlinear_True
2025-03-13 16:36:10 - INFO - Namespace(batch_size=32, epochs=5, int_digit_len=10, frac_digit_len=0, len_gen_size=0, lr=5e-05, name='test_run', model='gpt2', dataset='Onlydrinkwater/1000addition', train_from_scratch=True, use_digit_wise_tokenizer=False, num_train_samples=10, num_test_samples=None, seed=42, model_size_level=-1, method='fne', scheduler_name='cosine', period_base_list=[10.0], clip=True, not_add_linear=False, add_linear=True)
2025-03-13 16:36:10 - INFO - Dataset specified as single name: Onlydrinkwater/1000addition
2025-03-13 16:36:16 - INFO - Model initialized from scratch with default configuration.
2025-03-13 16:36:17 - INFO - Standard tokenizer loaded.
2025-03-13 16:36:17 - INFO - Expanding model config from 50257 to 50259 to match tokenizer.
2025-03-13 16:36:18 - INFO - Actual model size (total parameters): 124.44M
2025-03-13 16:36:18 - INFO - Padding token ID: 50257
2025-03-13 16:36:18 - INFO - [NUM] token ID: 50258
2025-03-13 16:36:27 - INFO - Train dataset length: 72000, Test dataset length: 20000
2025-03-13 16:36:35 - INFO - 2 data example: [{'input_ids': tensor([  220, 50258,   220,  1343,   220,   220, 50258,   220,   796,   220]), 'numbers': [678.0, 764.0], 'label': 1442.0}, {'input_ids': tensor([  220, 50258,   220,  1343,   220,   220, 50258,   220,   796,   220]), 'numbers': [365.0, 950.0], 'label': 1315.0}]
2025-03-13 16:36:35 - INFO - period_list: [10.0, 100.0, 1000.0, 10000.0, 100000.0, 1000000.0, 10000000.0, 100000000.0, 1000000000.0, 10000000000.0]
2025-03-13 16:36:35 - INFO - self.powers_of_ten: tensor([         1,         10,        100,       1000,      10000,     100000,
           1000000,   10000000,  100000000, 1000000000])
2025-03-13 16:36:35 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 16:36:35 - INFO - Starting Epoch 1/5
2025-03-13 16:36:39 - INFO - avg Loss: 2.702579975128174
2025-03-13 16:36:39 - INFO - Evaluation start
2025-03-13 16:47:22 - INFO - Mispredictions (up to 5 examples):
2025-03-13 16:47:22 - INFO - Predicted: 8605169466.0, Actual: 668.0
2025-03-13 16:47:22 - INFO - Predicted: 9815169456.0, Actual: 1697.0
2025-03-13 16:47:22 - INFO - Predicted: 8805169466.0, Actual: 869.0
2025-03-13 16:47:22 - INFO - Predicted: 8815169466.0, Actual: 1470.0
2025-03-13 16:47:22 - INFO - Predicted: 8605169466.0, Actual: 455.0
2025-03-13 16:47:22 - INFO - Epoch                                   1         
2025-03-13 16:47:22 - INFO - Train Loss                              2.7026
2025-03-13 16:47:22 - INFO - Test Loss                               2.6551
2025-03-13 16:47:22 - INFO - Whole Num Acc                           0.000000%
2025-03-13 16:47:22 - INFO - Digit-wise Acc                          5.727878%
2025-03-13 16:47:22 - INFO - MSE                                     80362215352723193856.000000
2025-03-13 16:47:22 - INFO - R^2                                     -486635455084030.750000000000000
2025-03-13 16:47:22 - INFO - Learning Rate                           0.000050
2025-03-13 16:47:22 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 16:47:22 - INFO - Starting Epoch 2/5
2025-03-13 16:47:26 - INFO - avg Loss: 2.625001907348633
2025-03-13 16:47:26 - INFO - Evaluation start
2025-03-13 16:58:32 - INFO - Mispredictions (up to 5 examples):
2025-03-13 16:58:32 - INFO - Predicted: 911542.0, Actual: 668.0
2025-03-13 16:58:32 - INFO - Predicted: 911542.0, Actual: 1697.0
2025-03-13 16:58:32 - INFO - Predicted: 911542.0, Actual: 869.0
2025-03-13 16:58:32 - INFO - Predicted: 911542.0, Actual: 1470.0
2025-03-13 16:58:32 - INFO - Predicted: 911542.0, Actual: 455.0
2025-03-13 16:58:32 - INFO - Epoch                                   2         
2025-03-13 16:58:32 - INFO - Train Loss                              2.6250
2025-03-13 16:58:32 - INFO - Test Loss                               1.5005
2025-03-13 16:58:32 - INFO - Whole Num Acc                           0.000000%
2025-03-13 16:58:32 - INFO - Digit-wise Acc                          7.201463%
2025-03-13 16:58:32 - INFO - MSE                                     824736135284.275146
2025-03-13 16:58:32 - INFO - R^2                                     -4994209.808608683757484
2025-03-13 16:58:32 - INFO - Learning Rate                           0.000043
2025-03-13 16:58:32 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 16:58:32 - INFO - Starting Epoch 3/5
2025-03-13 16:58:36 - INFO - avg Loss: 1.3129690885543823
2025-03-13 16:58:36 - INFO - Evaluation start
2025-03-13 17:12:33 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:12:33 - INFO - Predicted: 385.0, Actual: 668.0
2025-03-13 17:12:33 - INFO - Predicted: 385.0, Actual: 1697.0
2025-03-13 17:12:33 - INFO - Predicted: 385.0, Actual: 869.0
2025-03-13 17:12:33 - INFO - Predicted: 385.0, Actual: 1470.0
2025-03-13 17:12:33 - INFO - Predicted: 385.0, Actual: 455.0
2025-03-13 17:12:33 - INFO - Epoch                                   3         
2025-03-13 17:12:33 - INFO - Train Loss                              1.3130
2025-03-13 17:12:33 - INFO - Test Loss                               1.4571
2025-03-13 17:12:33 - INFO - Whole Num Acc                           0.040000%
2025-03-13 17:12:33 - INFO - Digit-wise Acc                          21.677158%
2025-03-13 17:12:33 - INFO - MSE                                     548427.507750
2025-03-13 17:12:33 - INFO - R^2                                     -2.321016831643117
2025-03-13 17:12:33 - INFO - Learning Rate                           0.000025
2025-03-13 17:12:33 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 17:12:33 - INFO - Starting Epoch 4/5
2025-03-13 17:12:37 - INFO - avg Loss: 1.2809646129608154
2025-03-13 17:12:37 - INFO - Evaluation start
2025-03-13 17:26:06 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:26:06 - INFO - Predicted: 455.0, Actual: 668.0
2025-03-13 17:26:06 - INFO - Predicted: 455.0, Actual: 1697.0
2025-03-13 17:26:06 - INFO - Predicted: 355.0, Actual: 869.0
2025-03-13 17:26:06 - INFO - Predicted: 455.0, Actual: 1470.0
2025-03-13 17:26:06 - INFO - Predicted: 455.0, Actual: 701.0
2025-03-13 17:26:06 - INFO - Epoch                                   4         
2025-03-13 17:26:06 - INFO - Train Loss                              1.2810
2025-03-13 17:26:06 - INFO - Test Loss                               1.3324
2025-03-13 17:26:06 - INFO - Whole Num Acc                           0.035000%
2025-03-13 17:26:06 - INFO - Digit-wise Acc                          22.379384%
2025-03-13 17:26:06 - INFO - MSE                                     478972.307750
2025-03-13 17:26:06 - INFO - R^2                                     -1.900429087619369
2025-03-13 17:26:06 - INFO - Learning Rate                           0.000007
2025-03-13 17:26:06 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 17:26:06 - INFO - Starting Epoch 5/5
2025-03-13 17:26:10 - INFO - avg Loss: 1.127974033355713
2025-03-13 17:26:10 - INFO - Evaluation start
2025-03-13 17:39:40 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:39:40 - INFO - Predicted: 454.0, Actual: 668.0
2025-03-13 17:39:40 - INFO - Predicted: 454.0, Actual: 1697.0
2025-03-13 17:39:40 - INFO - Predicted: 454.0, Actual: 869.0
2025-03-13 17:39:40 - INFO - Predicted: 454.0, Actual: 1470.0
2025-03-13 17:39:40 - INFO - Predicted: 454.0, Actual: 455.0
2025-03-13 17:39:40 - INFO - Epoch                                   5         
2025-03-13 17:39:40 - INFO - Train Loss                              1.1280
2025-03-13 17:39:40 - INFO - Test Loss                               1.2682
2025-03-13 17:39:40 - INFO - Whole Num Acc                           0.035000%
2025-03-13 17:39:40 - INFO - Digit-wise Acc                          22.306615%
2025-03-13 17:39:40 - INFO - MSE                                     464902.181450
2025-03-13 17:39:40 - INFO - R^2                                     -1.815227077134248
2025-03-13 17:39:40 - INFO - Learning Rate                           0.000000
2025-03-13 17:39:40 - INFO - Starting Final evaluation.
2025-03-13 17:39:40 - INFO - Evaluation start
2025-03-13 17:53:15 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:53:15 - INFO - Predicted: 454.0, Actual: 668.0
2025-03-13 17:53:15 - INFO - Predicted: 454.0, Actual: 1697.0
2025-03-13 17:53:15 - INFO - Predicted: 454.0, Actual: 869.0
2025-03-13 17:53:15 - INFO - Predicted: 454.0, Actual: 1470.0
2025-03-13 17:53:15 - INFO - Predicted: 454.0, Actual: 455.0
2025-03-13 17:53:15 - INFO - Final Test Results:
2025-03-13 17:53:15 - INFO - Test Loss                               1.2682
2025-03-13 17:53:15 - INFO - Whole Num Accuracy                      0.035000%
2025-03-13 17:53:15 - INFO - Digit-wise Accuracy                     22.306615%
2025-03-13 17:53:15 - INFO - MSE                                     464902.181450
2025-03-13 17:53:15 - INFO - R^2                                     -1.815227077134248
