2025-03-17 01:40:57 - INFO - result/test_run/train_from_scratch/gpt2/5_digits_sub/fne/period_base_list_[10.0]_batchsize_32_epochs_5_lr_5e-05_int_digit_len_10_frac_digit_len_0_seed42_num_train_samples_10000_model_size_level_-1_lengensize_0_addlinear_True
2025-03-17 01:40:57 - INFO - Namespace(batch_size=32, epochs=5, int_digit_len=10, frac_digit_len=0, len_gen_size=0, lr=5e-05, name='test_run', model='gpt2', dataset='5_digits_sub', train_from_scratch=True, use_digit_wise_tokenizer=False, num_train_samples=10000, num_test_samples=None, seed=42, model_size_level=-1, method='fne', scheduler_name='cosine', period_base_list=[10.0], clip=True, not_add_linear=False, add_linear=True)
2025-03-17 01:40:57 - INFO - Dataset specified as single name: 5_digits_sub
2025-03-17 01:40:59 - INFO - Model initialized from scratch with default configuration.
2025-03-17 01:40:59 - INFO - Standard tokenizer loaded.
2025-03-17 01:40:59 - INFO - Expanding model config from 50257 to 50259 to match tokenizer.
2025-03-17 01:40:59 - INFO - Actual model size (total parameters): 124.44M
2025-03-17 01:40:59 - INFO - Padding token ID: 50257
2025-03-17 01:40:59 - INFO - [NUM] token ID: 50258
2025-03-17 01:41:00 - INFO - Train dataset length: 720000, Test dataset length: 200000
2025-03-17 01:41:24 - INFO - 2 data example: [{'input_ids': tensor([  220, 50258,   532,   220, 50258,   796]), 'numbers': [50841.0, 33557.0], 'label': 17284.0}, {'input_ids': tensor([  220, 50258,   532,   220, 50258,   796]), 'numbers': [84663.0, 18020.0], 'label': 66643.0}]
2025-03-17 01:41:24 - INFO - period_list: [10.0, 100.0, 1000.0, 10000.0, 100000.0, 1000000.0, 10000000.0, 100000000.0, 1000000000.0, 10000000000.0]
2025-03-17 01:41:24 - INFO - self.powers_of_ten: tensor([         1,         10,        100,       1000,      10000,     100000,
           1000000,   10000000,  100000000, 1000000000])
2025-03-17 01:41:24 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-17 01:41:24 - INFO - Starting Epoch 1/5
2025-03-17 01:44:45 - INFO - avg Loss: 1.230685935614589
2025-03-17 01:44:45 - INFO - Evaluation start
2025-03-17 01:58:25 - INFO - Mispredictions (up to 5 examples):
2025-03-17 01:58:25 - INFO - Predicted: 41380.0, Actual: 41309.0
2025-03-17 01:58:25 - INFO - Predicted: 34435.0, Actual: 35066.0
2025-03-17 01:58:25 - INFO - Predicted: 3870.0, Actual: 2109.0
2025-03-17 01:58:25 - INFO - Predicted: 20055.0, Actual: 29947.0
2025-03-17 01:58:25 - INFO - Predicted: 44554.0, Actual: 53933.0
2025-03-17 01:58:25 - INFO - Epoch                                   1         
2025-03-17 01:58:25 - INFO - Train Loss                              1.2307
2025-03-17 01:58:25 - INFO - Test Loss                               0.9842
2025-03-17 01:58:25 - INFO - Whole Num Acc                           0.137000%
2025-03-17 01:58:25 - INFO - Digit-wise Acc                          44.664891%
2025-03-17 01:58:25 - INFO - MSE                                     76733566.238170
2025-03-17 01:58:25 - INFO - R^2                                     0.783182264203813
2025-03-17 01:58:25 - INFO - Learning Rate                           0.000050
2025-03-17 01:58:25 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-17 01:58:25 - INFO - Starting Epoch 2/5
2025-03-17 02:01:35 - INFO - avg Loss: 0.7891155702237505
2025-03-17 02:01:35 - INFO - Evaluation start
2025-03-17 02:15:01 - INFO - Mispredictions (up to 5 examples):
2025-03-17 02:15:01 - INFO - Predicted: 9001.0, Actual: 1.0
2025-03-17 02:15:01 - INFO - Predicted: 41419.0, Actual: 41309.0
2025-03-17 02:15:01 - INFO - Predicted: 35956.0, Actual: 35066.0
2025-03-17 02:15:01 - INFO - Predicted: 2019.0, Actual: 2109.0
2025-03-17 02:15:01 - INFO - Predicted: 39047.0, Actual: 29947.0
2025-03-17 02:15:01 - INFO - Epoch                                   2         
2025-03-17 02:15:01 - INFO - Train Loss                              0.7891
2025-03-17 02:15:01 - INFO - Test Loss                               0.5506
2025-03-17 02:15:01 - INFO - Whole Num Acc                           10.732500%
2025-03-17 02:15:01 - INFO - Digit-wise Acc                          72.812530%
2025-03-17 02:15:01 - INFO - MSE                                     34440882.997910
2025-03-17 02:15:01 - INFO - R^2                                     0.902684123304650
2025-03-17 02:15:01 - INFO - Learning Rate                           0.000043
2025-03-17 02:15:01 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-17 02:15:01 - INFO - Starting Epoch 3/5
2025-03-17 02:18:09 - INFO - avg Loss: 0.4935471365055718
2025-03-17 02:18:09 - INFO - Evaluation start
2025-03-17 02:31:30 - INFO - Mispredictions (up to 5 examples):
2025-03-17 02:31:30 - INFO - Predicted: 2119.0, Actual: 2109.0
2025-03-17 02:31:30 - INFO - Predicted: 39947.0, Actual: 29947.0
2025-03-17 02:31:30 - INFO - Predicted: 15177.0, Actual: 14177.0
2025-03-17 02:31:30 - INFO - Predicted: 65946.0, Actual: 64946.0
2025-03-17 02:31:30 - INFO - Predicted: 43700.0, Actual: 43710.0
2025-03-17 02:31:30 - INFO - Epoch                                   3         
2025-03-17 02:31:30 - INFO - Train Loss                              0.4935
2025-03-17 02:31:30 - INFO - Test Loss                               0.3816
2025-03-17 02:31:30 - INFO - Whole Num Acc                           76.210000%
2025-03-17 02:31:30 - INFO - Digit-wise Acc                          95.118257%
2025-03-17 02:31:30 - INFO - MSE                                     5491040.804520
2025-03-17 02:31:30 - INFO - R^2                                     0.984484560111475
2025-03-17 02:31:30 - INFO - Learning Rate                           0.000025
2025-03-17 02:31:30 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-17 02:31:30 - INFO - Starting Epoch 4/5
2025-03-17 02:34:38 - INFO - avg Loss: 0.4158113937789259
2025-03-17 02:34:38 - INFO - Evaluation start
2025-03-17 02:47:54 - INFO - Mispredictions (up to 5 examples):
2025-03-17 02:47:54 - INFO - Predicted: 2119.0, Actual: 2109.0
2025-03-17 02:47:54 - INFO - Predicted: 30947.0, Actual: 29947.0
2025-03-17 02:47:54 - INFO - Predicted: 25979.0, Actual: 24979.0
2025-03-17 02:47:54 - INFO - Predicted: 65946.0, Actual: 64946.0
2025-03-17 02:47:54 - INFO - Predicted: 4779.0, Actual: 4769.0
2025-03-17 02:47:54 - INFO - Epoch                                   4         
2025-03-17 02:47:54 - INFO - Train Loss                              0.4158
2025-03-17 02:47:54 - INFO - Test Loss                               0.3574
2025-03-17 02:47:54 - INFO - Whole Num Acc                           90.544500%
2025-03-17 02:47:54 - INFO - Digit-wise Acc                          98.022662%
2025-03-17 02:47:54 - INFO - MSE                                     1788312.707600
2025-03-17 02:47:54 - INFO - R^2                                     0.994946958271770
2025-03-17 02:47:54 - INFO - Learning Rate                           0.000007
2025-03-17 02:47:54 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-17 02:47:54 - INFO - Starting Epoch 5/5
2025-03-17 02:51:02 - INFO - avg Loss: 0.3955759013803622
2025-03-17 02:51:02 - INFO - Evaluation start
2025-03-17 03:04:19 - INFO - Mispredictions (up to 5 examples):
2025-03-17 03:04:19 - INFO - Predicted: 65946.0, Actual: 64946.0
2025-03-17 03:04:19 - INFO - Predicted: 43700.0, Actual: 43710.0
2025-03-17 03:04:19 - INFO - Predicted: 39920.0, Actual: 29920.0
2025-03-17 03:04:19 - INFO - Predicted: 50998.0, Actual: 59998.0
2025-03-17 03:04:19 - INFO - Predicted: 3941.0, Actual: 2941.0
2025-03-17 03:04:19 - INFO - Epoch                                   5         
2025-03-17 03:04:19 - INFO - Train Loss                              0.3956
2025-03-17 03:04:19 - INFO - Test Loss                               0.3487
2025-03-17 03:04:19 - INFO - Whole Num Acc                           95.528000%
2025-03-17 03:04:19 - INFO - Digit-wise Acc                          99.053265%
2025-03-17 03:04:19 - INFO - MSE                                     901075.784000
2025-03-17 03:04:19 - INFO - R^2                                     0.997453927650629
2025-03-17 03:04:19 - INFO - Learning Rate                           0.000000
2025-03-17 03:04:19 - INFO - Starting Final evaluation.
2025-03-17 03:04:19 - INFO - Evaluation start
