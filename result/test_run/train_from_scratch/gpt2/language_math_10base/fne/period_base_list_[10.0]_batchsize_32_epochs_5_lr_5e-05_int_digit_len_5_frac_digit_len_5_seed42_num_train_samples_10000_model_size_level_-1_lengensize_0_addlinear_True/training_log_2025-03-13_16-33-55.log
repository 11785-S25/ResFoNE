2025-03-13 16:33:55 - INFO - result/test_run/train_from_scratch/gpt2/language_math_10base/fne/period_base_list_[10.0]_batchsize_32_epochs_5_lr_5e-05_int_digit_len_5_frac_digit_len_5_seed42_num_train_samples_10000_model_size_level_-1_lengensize_0_addlinear_True
2025-03-13 16:33:55 - INFO - Namespace(batch_size=32, epochs=5, int_digit_len=5, frac_digit_len=5, len_gen_size=0, lr=5e-05, name='test_run', model='gpt2', dataset='Onlydrinkwater/language_math_10base', train_from_scratch=True, use_digit_wise_tokenizer=False, num_train_samples=10000, num_test_samples=None, seed=42, model_size_level=-1, method='fne', scheduler_name='cosine', period_base_list=[10.0], clip=True, not_add_linear=False, add_linear=True)
2025-03-13 16:33:55 - INFO - Dataset specified as single name: Onlydrinkwater/language_math_10base
2025-03-13 16:34:00 - INFO - Model initialized from scratch with default configuration.
2025-03-13 16:34:00 - INFO - Standard tokenizer loaded.
2025-03-13 16:34:00 - INFO - Expanding model config from 50257 to 50259 to match tokenizer.
2025-03-13 16:34:01 - INFO - Actual model size (total parameters): 124.44M
2025-03-13 16:34:01 - INFO - Padding token ID: 50257
2025-03-13 16:34:01 - INFO - [NUM] token ID: 50258
2025-03-13 16:34:03 - INFO - Train dataset length: 27352, Test dataset length: 3420
2025-03-13 16:34:06 - INFO - 2 data example: [{'input_ids': tensor([14957,   286,   220,   220, 50258,   220,   290,   220,   220, 50258,
          220]), 'numbers': [177.0, 219.0], 'label': 396.0}, {'input_ids': tensor([ 9771,  3129,   378,   220,   220, 50258,   220,  1343,   220,   220,
        50258,   220]), 'numbers': [71.0, 93.0], 'label': 164.0}]
2025-03-13 16:34:06 - INFO - period_list: [0.0001, 0.001, 0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0, 100000.0]
2025-03-13 16:34:06 - INFO - self.powers_of_ten: tensor([         1,         10,        100,       1000,      10000,     100000,
           1000000,   10000000,  100000000, 1000000000])
2025-03-13 16:34:06 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 16:34:06 - INFO - Starting Epoch 1/5
2025-03-13 17:04:04 - INFO - avg Loss: 0.7843970763988007
2025-03-13 17:04:04 - INFO - Evaluation start
2025-03-13 17:06:48 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:06:48 - INFO - Predicted: 168.0, Actual: 158.0
2025-03-13 17:06:48 - INFO - Predicted: 400.0, Actual: 410.0
2025-03-13 17:06:48 - INFO - Predicted: 304.0, Actual: 405.0
2025-03-13 17:06:48 - INFO - Predicted: 110.0, Actual: 120.0
2025-03-13 17:06:48 - INFO - Predicted: 412.0, Actual: 512.0
2025-03-13 17:06:48 - INFO - Epoch                                   1         
2025-03-13 17:06:48 - INFO - Train Loss                              0.7844
2025-03-13 17:06:48 - INFO - Test Loss                               0.4191
2025-03-13 17:06:48 - INFO - Whole Num Acc                           47.573099%
2025-03-13 17:06:48 - INFO - Digit-wise Acc                          85.561497%
2025-03-13 17:06:48 - INFO - MSE                                     1177.159357
2025-03-13 17:06:48 - INFO - R^2                                     0.902202744293441
2025-03-13 17:06:48 - INFO - Learning Rate                           0.000050
2025-03-13 17:06:48 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 17:06:48 - INFO - Starting Epoch 2/5
2025-03-13 17:35:52 - INFO - avg Loss: 0.4009575768591116
2025-03-13 17:35:52 - INFO - Evaluation start
2025-03-13 17:38:30 - INFO - Mispredictions (up to 5 examples):
2025-03-13 17:38:30 - INFO - Predicted: 432.0, Actual: 422.0
2025-03-13 17:38:30 - INFO - Predicted: 492.0, Actual: 392.0
2025-03-13 17:38:30 - INFO - Predicted: 490.0, Actual: 390.0
2025-03-13 17:38:30 - INFO - Predicted: 328.0, Actual: 318.0
2025-03-13 17:38:30 - INFO - Predicted: 353.0, Actual: 343.0
2025-03-13 17:38:30 - INFO - Epoch                                   2         
2025-03-13 17:38:30 - INFO - Train Loss                              0.4010
2025-03-13 17:38:30 - INFO - Test Loss                               0.3630
2025-03-13 17:38:30 - INFO - Whole Num Acc                           80.964912%
2025-03-13 17:38:30 - INFO - Digit-wise Acc                          95.745692%
2025-03-13 17:38:30 - INFO - MSE                                     285.737719
2025-03-13 17:38:30 - INFO - R^2                                     0.976261187884569
2025-03-13 17:38:30 - INFO - Learning Rate                           0.000043
2025-03-13 17:38:30 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 17:38:30 - INFO - Starting Epoch 3/5
2025-03-13 18:07:55 - INFO - avg Loss: 0.3659709413973287
2025-03-13 18:07:55 - INFO - Evaluation start
2025-03-13 18:09:57 - INFO - Mispredictions (up to 5 examples):
2025-03-13 18:09:57 - INFO - Predicted: 400.0, Actual: 410.0
2025-03-13 18:09:57 - INFO - Predicted: 220.0, Actual: 230.0
2025-03-13 18:09:57 - INFO - Predicted: 140.0, Actual: 150.0
2025-03-13 18:09:57 - INFO - Predicted: 230.0, Actual: 240.0
2025-03-13 18:09:57 - INFO - Predicted: 130.0, Actual: 140.0
2025-03-13 18:09:57 - INFO - Epoch                                   3         
2025-03-13 18:09:57 - INFO - Train Loss                              0.3660
2025-03-13 18:09:57 - INFO - Test Loss                               0.3354
2025-03-13 18:09:57 - INFO - Whole Num Acc                           99.064327%
2025-03-13 18:09:57 - INFO - Digit-wise Acc                          99.792038%
2025-03-13 18:09:57 - INFO - MSE                                     6.813743
2025-03-13 18:09:57 - INFO - R^2                                     0.999433920877092
2025-03-13 18:09:57 - INFO - Learning Rate                           0.000025
2025-03-13 18:09:57 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 18:09:57 - INFO - Starting Epoch 4/5
2025-03-13 18:31:04 - INFO - avg Loss: 0.35058987607209446
2025-03-13 18:31:04 - INFO - Evaluation start
2025-03-13 18:33:13 - INFO - Mispredictions (up to 1 examples):
2025-03-13 18:33:13 - INFO - Predicted: 157.0, Actual: 147.0
2025-03-13 18:33:13 - INFO - Epoch                                   4         
2025-03-13 18:33:13 - INFO - Train Loss                              0.3506
2025-03-13 18:33:13 - INFO - Test Loss                               0.3300
2025-03-13 18:33:13 - INFO - Whole Num Acc                           99.970760%
2025-03-13 18:33:13 - INFO - Digit-wise Acc                          99.994058%
2025-03-13 18:33:13 - INFO - MSE                                     0.029240
2025-03-13 18:33:13 - INFO - R^2                                     0.999997570788641
2025-03-13 18:33:13 - INFO - Learning Rate                           0.000007
2025-03-13 18:33:13 - INFO - ----------------------------------------------------------------------------------------------------
2025-03-13 18:33:13 - INFO - Starting Epoch 5/5
2025-03-13 18:55:50 - INFO - avg Loss: 0.3446253012544431
2025-03-13 18:55:50 - INFO - Evaluation start
2025-03-13 18:57:55 - INFO - Mispredictions (up to 1 examples):
2025-03-13 18:57:55 - INFO - Predicted: 157.0, Actual: 147.0
2025-03-13 18:57:55 - INFO - Epoch                                   5         
2025-03-13 18:57:55 - INFO - Train Loss                              0.3446
2025-03-13 18:57:55 - INFO - Test Loss                               0.3277
2025-03-13 18:57:55 - INFO - Whole Num Acc                           99.970760%
2025-03-13 18:57:55 - INFO - Digit-wise Acc                          99.994058%
2025-03-13 18:57:55 - INFO - MSE                                     0.029240
2025-03-13 18:57:55 - INFO - R^2                                     0.999997570788641
2025-03-13 18:57:55 - INFO - Learning Rate                           0.000000
2025-03-13 18:57:55 - INFO - Starting Final evaluation.
2025-03-13 18:57:55 - INFO - Evaluation start
2025-03-13 19:00:02 - INFO - Mispredictions (up to 1 examples):
2025-03-13 19:00:02 - INFO - Predicted: 157.0, Actual: 147.0
2025-03-13 19:00:02 - INFO - Final Test Results:
2025-03-13 19:00:02 - INFO - Test Loss                               0.3277
2025-03-13 19:00:02 - INFO - Whole Num Accuracy                      99.970760%
2025-03-13 19:00:02 - INFO - Digit-wise Accuracy                     99.994058%
2025-03-13 19:00:02 - INFO - MSE                                     0.029240
2025-03-13 19:00:02 - INFO - R^2                                     0.999997570788641
